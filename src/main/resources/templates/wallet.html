<!doctype html>
<html class="no-js" lang="en">

<head>
    <title th:text="${pageTitle} ?: 'My Wallet'"></title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Including CSS Files from base.html -->
    <th:block th:replace="~{base :: head}"></th:block>
</head>

<body class="sticky-header newsletter-popup-modal">

<!-- Include Header Fragment -->
<div th:replace="base :: header"></div>

<!-- Main Content Section -->
<main class="main-wrapper">
    <!-- Start My Account Area  -->
    <div class="axil-dashboard-area axil-section-gap">
        <div class="container">
            <div class="axil-dashboard-warp">
                <!-- Dashboard Sidebar and Content Container -->
                <div class="row">
                    <div class="axil-dashboard-author">
                        <div class="media">
                            <div class="thumbnail">
                                <img th:src="@{/images/product/author1.png}">
                            </div>
                            <div class="media-body">
                                <h5 class="title mb-0" th:text="'Hello ' + ${user.getUsername()}"></h5>
                                <span class="joining-date" th:text="'Register Since ' + ${createdAtFormatted}"></span>
                            </div>
                        </div>
                    </div>
                    <!-- Sidebar -->
                    <div class="col-xl-3 col-md-4">
                        <aside th:insert="~{sidebar :: sidebar}">
                        </aside>
                    </div>
                    <!-- Dashboard Content -->
                    <div class="col-xl-9 col-md-8">
                        <div class="tab-content">
                            <!-- Wallet Tab -->
                            <div id="nav-wallet" class="tab-pane fade show active" role="tabpanel">
                                <div class="wallet-section axil-dashboard-order">
                                    <h3>Wallet</h3>
                                    <p>Số dư: <span id="wallet-balance">1,000,000 VND</span></p>
                                    <input type="submit" class="axil-btn" value="Rút tiền"
                                           style="background: red; border: none" id="withdraw">
                                    <input type="submit" class="axil-btn" id="deposit"
                                           style="background: green; border: none" value="Nạp tiền">
                                    <!-- Transaction History -->
                                    <h4>Lịch sử giao dịch</h4>
                                    <table class="table">
                                        <thead>
                                        <tr>
                                            <th>Ngày</th>
                                            <th>Loại giao dịch</th>
                                            <th>Số tiền</th>
                                            <th>Trạng thái</th>
                                        </tr>
                                        </thead>
                                        <tbody id="transaction-history">
                                        <tr>
                                            <td>01/10/2024</td>
                                            <td>Nạp tiền</td>
                                            <td>500,000 VND</td>
                                            <td>Thành công</td>
                                        </tr>
                                        <tr>
                                            <td>25/09/2024</td>
                                            <td>Rút tiền</td>
                                            <td>300,000 VND</td>
                                            <td>Thành công</td>
                                        </tr>
                                        <!-- More transactions -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div> <!-- End of tab-content -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal for Rút Tiền -->
    <div id="withdrawModal" class="modal" style="display:none;">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Rút Tiền</h2>
            <form id="withdrawForm">
                <label for="bank-name">Tên Ngân Hàng:</label>
                <input type="text" id="bank-name" name="bank-name" required><br><br>
                <label for="account-number">Số Tài Khoản:</label>
                <input type="text" id="account-number" name="account-number" required><br><br>
                <button type="submit">Xác nhận</button>
            </form>
        </div>
    </div>

    <!-- Modal for Nạp Tiền -->
    <div id="depositModal" class="modal" style="display:none;">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Nạp Tiền</h2>
            <form id="depositForm">
                <label for="bank-name">Tên Ngân Hàng:</label>
                <input type="text" id="bank-name" name="bank-name" required><br><br>
                <label for="account-number">Số Tài Khoản:</label>
                <input type="text" id="account-number" name="account-number" required><br><br>
                <label for="amount">Số Tiền Nạp:</label>
                <input type="number" id="amount" name="amount" required><br><br>
                <button type="submit">Xác nhận</button>
            </form>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="modal" style="display:none;">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Thành Công!</h2>
            <p>Giao dịch đã được thực hiện thành công.</p>
        </div>
    </div>
</main>

<!-- Include Footer Fragment -->
<div th:replace="base :: footer"></div>

<!-- JS
============================================ -->
<script src="../static/js/vendor/modernizr.min.js"></script>
<script src="../static/js/vendor/jquery.js"></script>
<script src="../static/js/vendor/popper.min.js"></script>
<script src="../static/js/vendor/bootstrap.min.js"></script>
<script src="../static/js/vendor/slick.min.js"></script>
<script src="../static/js/vendor/js.cookie.js"></script>
<script src="../static/js/vendor/jquery-ui.min.js"></script>
<script src="../static/js/vendor/jquery.ui.touch-punch.min.js"></script>
<script src="../static/js/vendor/jquery.countdown.min.js"></script>
<script src="../static/js/vendor/sal.js"></script>
<script src="../static/js/vendor/jquery.magnific-popup.min.js"></script>
<script src="../static/js/vendor/imagesloaded.pkgd.min.js"></script>
<script src="../static/js/vendor/isotope.pkgd.min.js"></script>
<script src="../static/js/vendor/counterup.js"></script>
<script src="../static/js/vendor/waypoints.min.js"></script>
<script src="../static/js/main.js"></script>
<script src="../static/js/script.js"></script>

<script>
    // Get the modal elements
    var withdrawModal = document.getElementById("withdrawModal");
    var depositModal = document.getElementById("depositModal");
    var successModal = document.getElementById("successModal");

    // Get the buttons that open the modal
    var withdrawBtn = document.getElementById("withdraw");
    var depositBtn = document.getElementById("deposit");

    // Get the close buttons
    var closeBtns = document.getElementsByClassName("close");

    // When the user clicks on the withdraw button, open the withdraw modal
    withdrawBtn.onclick = function () {
        withdrawModal.style.display = "block";
    }

    // When the user clicks on the deposit button, open the deposit modal
    depositBtn.onclick = function () {
        depositModal.style.display = "block";
    }

    // When the user clicks on any of the close buttons, close the modal
    for (var i = 0; i < closeBtns.length; i++) {
        closeBtns[i].onclick = function () {
            withdrawModal.style.display = "none";
            depositModal.style.display = "none";
            successModal.style.display = "none";
        }
    }

    // Close the modal when user clicks outside of it
    window.onclick = function (event) {
        if (event.target == withdrawModal || event.target == depositModal || event.target == successModal) {
            withdrawModal.style.display = "none";
            depositModal.style.display = "none";
            successModal.style.display = "none";
        }
    }

    // Simulate a successful transaction and show the success modal
    function showSuccessModal() {
        withdrawModal.style.display = "none";
        depositModal.style.display = "none";
        successModal.style.display = "block";
        setTimeout(function () {
            location.reload(); // Reload page after success modal is closed
        }, 2000); // Adjust delay as needed
    }

    // Handle form submission for withdraw and deposit
    document.getElementById("withdrawForm").onsubmit = function (event) {
        event.preventDefault();
        showSuccessModal(); // Show success modal on submit
    }

    document.getElementById("depositForm").onsubmit = function (event) {
        event.preventDefault();
        showSuccessModal(); // Show success modal on submit
    }
</script>
</body>
</html>